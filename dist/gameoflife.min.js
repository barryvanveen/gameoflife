"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},_createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),GameOfLife=function(){function t(e){_classCallCheck(this,t),this._defaults={canvas_id:"gameoflife_canvas",num_cols:80,num_rows:40,cell_size:10,color_lines:"#cccccc",color_cell_empty:"#ffffff",color_cell_selected:"#57A0DB",update_interval:50},this._interval=null,this._initConfig(e),this._initCanvas(),this._initCells(),this._initEventListeners()}return _createClass(t,[{key:"_initConfig",value:function(t){var e;if(this.config=this._defaults,"object"==("undefined"==typeof t?"undefined":_typeof(t)))for(e in t)"undefined"!=typeof this.config[e]&&"object"!=_typeof(t[e])&&(this.config[e]=t[e])}},{key:"_initCanvas",value:function(){if(this.canvas=document.getElementById(this.config.canvas_id),console.log(this.canvas),null==this.canvas)throw new Error("Canvas element could not be found.");if(this.context=this.canvas.getContext("2d"),!this.context)throw new Error("Canvas context could not be retrieved.");this.context.fillStyle=this.config.color_cell_selected,this.context.strokeStyle=this.config.color_lines,this.canvas.width=this.config.num_cols*this.config.cell_size+1,this.canvas.height=this.config.num_rows*this.config.cell_size+1,this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<=this.canvas.width;t+=this.config.cell_size)this.context.moveTo(.5+t,0),this.context.lineTo(.5+t,this.canvas.width);for(var e=0;e<=this.canvas.width;e+=this.config.cell_size)this.context.moveTo(0,.5+e),this.context.lineTo(this.canvas.width,.5+e);this.context.stroke()}},{key:"_initCells",value:function(){var t,e=this.config.num_cols;for(this.cells=[],this.newCells=[];e--;)for(this.cells[e]=[],this.newCells[e]=[],t=this.config.num_rows;t--;)this.cells[e][t]=0,this.newCells[e][t]=0}},{key:"_initEventListeners",value:function(){var t=this;document.addEventListener?this.canvas.addEventListener("click",function(e){t._handleClick(e)},!1):document.attachEvent&&this.canvas.attachEvent("click",function(e){t._handleClick(e)})}},{key:"_handleClick",value:function(t){var e=this._getCellFromCursorPosition(t);0!=e&&(this.cells[e[0]][e[1]]=!this.cells[e[0]][e[1]],this._drawCell(e[0],e[1]))}},{key:"_getCellFromCursorPosition",value:function(e){var i,n;"undefined"!=typeof e.pageX&&"undefined"!=typeof e.pageY?(i=e.pageX,n=e.pageY):(i=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=e.clientY+document.body.scrollTop+document.documentElement.scrollTop);var s=t.getPosition(this.canvas);return i-=s[0],n-=s[1],i>this.config.num_cols*this.config.cell_size||n>this.config.num_rows*this.config.cell_size?!1:[Math.floor(i/this.config.cell_size),Math.floor(n/this.config.cell_size)]}},{key:"_drawCell",value:function(t,e){this.cells[t][e]?this.context.fillStyle=this.config.color_cell_selected:this.context.fillStyle=this.config.color_cell_empty,this.context.fillRect(1+t*this.config.cell_size,1+e*this.config.cell_size,this.config.cell_size-1,this.config.cell_size-1)}},{key:"reset",value:function(){this.stop(),this._initCells(),this._initCanvas()}},{key:"start",value:function(){if(null==this._interval){var t=this;this._interval=setInterval(function(){t._computeNextGeneration()},this.config.update_interval)}}},{key:"step",value:function(){clearInterval(this._interval),this._interval=null,this._computeNextGeneration()}},{key:"stop",value:function(){clearInterval(this._interval),this._interval=null}},{key:"_computeNextGeneration",value:function(){var e,i,n,s,o,l,c=0,a=!1;for(e=this.config.num_cols;e--;)for(i=this.config.num_rows;i--;){for(c=0,s=-1;1>=s;++s)for(n=-1;1>=n;++n)0==s&&0==n||(o=e+s,(0>o||o>=this.config.num_cols)&&(o=t.mod(this.config.num_cols,o)),l=i+n,(0>l||l>=this.config.num_rows)&&(l=t.mod(this.config.num_rows,l)),this.cells[o][l]&&c++);2>c||c>3?this.newCells[e][i]=0:2==c?this.newCells[e][i]=this.cells[e][i]:this.newCells[e][i]=1}for(e=this.config.num_cols;e--;)for(i=this.config.num_rows;i--;)this.cells[e][i]!=this.newCells[e][i]&&(this.cells[e][i]=this.newCells[e][i],this._drawCell(e,i),a=!0);a||this.stop()}}],[{key:"getPosition",value:function(t){var e=0,i=0;if(t.offsetParent)do e+=t.offsetLeft,i+=t.offsetTop;while(t=t.offsetParent);return[e,i]}},{key:"mod",value:function(t,e){return(e%t+t)%t}}]),t}();
//# sourceMappingURL=gameoflife.min.js.map
