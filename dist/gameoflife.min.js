GameOfLife={},GameOfLife.defaults={canvas_id:"gameoflife_canvas",num_cols:80,num_rows:40,cell_size:10,color_lines:"#cccccc",color_cell_empty:"#ffffff",color_cell_selected:"#57A0DB",update_interval:50},GameOfLife.init=function(t){this._initConfig(t),this._initCanvas(),this._initCells(),this._initEventListeners(),this.interval=null},GameOfLife._initConfig=function(t){var i;if(this.config=this.defaults,"object"==typeof t){for(i in t)"undefined"!=typeof this.config[i]&&"object"!=typeof t[i]&&(this.config[i]=t[i]);for(i in this.constants)this.config[i]=this.constants[i]}},GameOfLife._initCanvas=function(){if(this.canvas=document.getElementById(this.config.canvas_id),null==this.canvas)throw new Error("Canvas element could not be found.");if(this.context=this.canvas.getContext("2d"),!this.context)throw new Error("Canvas context could not be retrieved.");this.context.fillStyle=this.config.color_cell_selected,this.context.strokeStyle=this.config.color_lines,this.config.canvas_offset=this._getPosition(this.canvas),this.canvas.width=this.config.num_cols*this.config.cell_size+1,this.canvas.height=this.config.num_rows*this.config.cell_size+1,this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<=this.canvas.width;t+=this.config.cell_size)this.context.moveTo(.5+t,0),this.context.lineTo(.5+t,this.canvas.width);for(var i=0;i<=this.canvas.width;i+=this.config.cell_size)this.context.moveTo(0,.5+i),this.context.lineTo(this.canvas.width,.5+i);this.context.stroke()},GameOfLife._getPosition=function(t){var i=0,e=0;if(t.offsetParent)do i+=t.offsetLeft,e+=t.offsetTop;while(t=t.offsetParent);return[i,e]},GameOfLife._initCells=function(){var t,i=this.config.num_cols;for(this.cells=[],this.newCells=[];i--;)for(this.cells[i]=[],this.newCells[i]=[],t=this.config.num_rows;t--;)this.cells[i][t]=0,this.newCells[i][t]=0},GameOfLife._initEventListeners=function(){var t=this;document.addEventListener?this.canvas.addEventListener("click",function(i){t._handleClick(i)},!1):document.attachEvent&&this.canvas.attachEvent("click",function(i){t._handleClick(i)})},GameOfLife._handleClick=function(t){var i=this._getCellFromCursorPosition(t);0!=i&&(this.cells[i[0]][i[1]]=!this.cells[i[0]][i[1]],this._drawCell(i[0],i[1]))},GameOfLife._getCellFromCursorPosition=function(t){var i,e;return"undefined"!=typeof t.pageX&&"undefined"!=typeof t.pageY?(i=t.pageX,e=t.pageY):(i=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,e=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),i-=this.config.canvas_offset[0],e-=this.config.canvas_offset[1],i>this.config.num_cols*this.config.cell_size||e>this.config.num_rows*this.config.cell_size?!1:[Math.floor(i/this.config.cell_size),Math.floor(e/this.config.cell_size)]},GameOfLife._drawCell=function(t,i){this.cells[t][i]?this.context.fillStyle=this.config.color_cell_selected:this.context.fillStyle=this.config.color_cell_empty,this.context.fillRect(1+t*this.config.cell_size,1+i*this.config.cell_size,this.config.cell_size-1,this.config.cell_size-1)},GameOfLife.reset=function(){this.stop(),this._initCells(),this._initCanvas()},GameOfLife.start=function(){if(null==this.interval){var t=this;this.interval=setInterval(function(){t._computeNextGeneration()},this.config.update_interval)}},GameOfLife.step=function(){clearInterval(this.interval),this.interval=null,this._computeNextGeneration()},GameOfLife.stop=function(){clearInterval(this.interval),this.interval=null},GameOfLife._computeNextGeneration=function(){var t,i,e,n,s,o,c=0,l=!1;for(t=this.config.num_cols;t--;)for(i=this.config.num_rows;i--;){for(c=0,n=-1;1>=n;++n)for(e=-1;1>=e;++e)0==n&&0==e||(s=t+n,(0>s||s>=this.config.num_cols)&&(s=this._mod(this.config.num_cols,s)),o=i+e,(0>o||o>=this.config.num_rows)&&(o=this._mod(this.config.num_rows,o)),this.cells[s][o]&&c++);2>c||c>3?this.newCells[t][i]=0:2==c?this.newCells[t][i]=this.cells[t][i]:this.newCells[t][i]=1}for(t=this.config.num_cols;t--;)for(i=this.config.num_rows;i--;)this.cells[t][i]!=this.newCells[t][i]&&(this.cells[t][i]=this.newCells[t][i],this._drawCell(t,i),l=!0);l||this.stop()},GameOfLife._mod=function(t,i){return(i%t+t)%t};
//# sourceMappingURL=gameoflife.min.js.map
