var Barryvanveen=Barryvanveen||{};Barryvanveen.GameOfLife=Barryvanveen.GameOfLife||function(){this.init=function(t){this.initConfig(t),this.initCanvas(),this.initCells(),this.initEventListeners(),this.interval=null},this.initConfig=function(t){var i;if(this.config=this.defaults,"object"==typeof t)for(i in t)"undefined"!=typeof this.config[i]&&"object"!=typeof t[i]&&(this.config[i]=t[i])},this.initCanvas=function(){if(this.canvas=document.getElementById(this.config.canvas_id),console.log(this.canvas),null==this.canvas)throw new Error("Canvas element could not be found.");if(this.context=this.canvas.getContext("2d"),!this.context)throw new Error("Canvas context could not be retrieved.");this.context.fillStyle=this.config.color_cell_selected,this.context.strokeStyle=this.config.color_lines,this.config.canvas_offset=this.getPosition(this.canvas),console.log(this.config.canvas_offset),this.canvas.width=this.config.num_cols*this.config.cell_size+1,this.canvas.height=this.config.num_rows*this.config.cell_size+1,this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var t=0;t<=this.canvas.width;t+=this.config.cell_size)this.context.moveTo(.5+t,0),this.context.lineTo(.5+t,this.canvas.width);for(var i=0;i<=this.canvas.width;i+=this.config.cell_size)this.context.moveTo(0,.5+i),this.context.lineTo(this.canvas.width,.5+i);this.context.stroke()},this.getPosition=function(t){var i=0,s=0;if(t.offsetParent)do i+=t.offsetLeft,s+=t.offsetTop;while(t=t.offsetParent);return[i,s]},this.initCells=function(){var t,i=this.config.num_cols;for(this.cells=[],this.newCells=[];i--;)for(this.cells[i]=[],this.newCells[i]=[],t=this.config.num_rows;t--;)this.cells[i][t]=0,this.newCells[i][t]=0},this.initEventListeners=function(){var t=this;document.addEventListener?this.canvas.addEventListener("click",function(i){t.handleClick(i)},!1):document.attachEvent&&this.canvas.attachEvent("click",function(i){t.handleClick(i)})},this.handleClick=function(t){var i=this.getCellFromCursorPosition(t);console.log(i),0!=i&&(this.cells[i[0]][i[1]]=!this.cells[i[0]][i[1]],this.drawCell(i[0],i[1]))},this.getCellFromCursorPosition=function(t){var i,s;return"undefined"!=typeof t.pageX&&"undefined"!=typeof t.pageY?(i=t.pageX,s=t.pageY):(i=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,s=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),console.log(this.config.canvas_offset),i-=this.config.canvas_offset[0],s-=this.config.canvas_offset[1],i>this.config.num_cols*this.config.cell_size||s>this.config.num_rows*this.config.cell_size?!1:[Math.floor(i/this.config.cell_size),Math.floor(s/this.config.cell_size)]},this.drawCell=function(t,i){this.cells[t][i]?this.context.fillStyle=this.config.color_cell_selected:this.context.fillStyle=this.config.color_cell_empty,this.context.fillRect(1+t*this.config.cell_size,1+i*this.config.cell_size,this.config.cell_size-1,this.config.cell_size-1)},this.reset=function(){this.stop(),this.initCells(),this.initCanvas()},this.start=function(){if(null==this.interval){var t=this;this.interval=setInterval(function(){t.computeNextGeneration()},this.config.update_interval)}},this.step=function(){clearInterval(this.interval),this.interval=null,this.computeNextGeneration()},this.stop=function(){clearInterval(this.interval),this.interval=null},this.computeNextGeneration=function(){var t,i,s,n,e,o,c=0,l=!1;for(t=this.config.num_cols;t--;)for(i=this.config.num_rows;i--;){for(c=0,n=-1;1>=n;++n)for(s=-1;1>=s;++s)0==n&&0==s||(e=t+n,(0>e||e>=this.config.num_cols)&&(e=this.mod(this.config.num_cols,e)),o=i+s,(0>o||o>=this.config.num_rows)&&(o=this.mod(this.config.num_rows,o)),this.cells[e][o]&&c++);2>c||c>3?this.newCells[t][i]=0:2==c?this.newCells[t][i]=this.cells[t][i]:this.newCells[t][i]=1}for(t=this.config.num_cols;t--;)for(i=this.config.num_rows;i--;)this.cells[t][i]!=this.newCells[t][i]&&(this.cells[t][i]=this.newCells[t][i],this.drawCell(t,i),l=!0);l||this.stop()},this.mod=function(t,i){return(i%t+t)%t},this.defaults={canvas_id:"gameoflife_canvas",num_cols:80,num_rows:40,cell_size:10,color_lines:"#cccccc",color_cell_empty:"#ffffff",color_cell_selected:"#57A0DB",update_interval:50}};
//# sourceMappingURL=gameoflife.min.js.map
