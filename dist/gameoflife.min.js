var Barryvanveen=Barryvanveen||{};Barryvanveen.GameOfLife=Barryvanveen.GameOfLife||{},Barryvanveen.GameOfLife.defaults={canvas_id:"gameoflife_canvas",num_cols:80,num_rows:40,cell_size:10,color_lines:"#cccccc",color_cell_empty:"#ffffff",color_cell_selected:"#57A0DB",update_interval:50},Barryvanveen.GameOfLife.init=function(e){this._initConfig(e),this._initCanvas(),this._initCells(),this._initEventListeners(),this.interval=null},Barryvanveen.GameOfLife._initConfig=function(e){var t;if(this.config=this.defaults,"object"==typeof e){for(t in e)"undefined"!=typeof this.config[t]&&"object"!=typeof e[t]&&(this.config[t]=e[t]);for(t in this.constants)this.config[t]=this.constants[t]}},Barryvanveen.GameOfLife._initCanvas=function(){if(this.canvas=document.getElementById(this.config.canvas_id),null==this.canvas)throw new Error("Canvas element could not be found.");if(this.context=this.canvas.getContext("2d"),!this.context)throw new Error("Canvas context could not be retrieved.");this.context.fillStyle=this.config.color_cell_selected,this.context.strokeStyle=this.config.color_lines,this.config.canvas_offset=this._getPosition(this.canvas),this.canvas.width=this.config.num_cols*this.config.cell_size+1,this.canvas.height=this.config.num_rows*this.config.cell_size+1,this.context.clearRect(0,0,this.canvas.width,this.canvas.height);for(var e=0;e<=this.canvas.width;e+=this.config.cell_size)this.context.moveTo(.5+e,0),this.context.lineTo(.5+e,this.canvas.width);for(var t=0;t<=this.canvas.width;t+=this.config.cell_size)this.context.moveTo(0,.5+t),this.context.lineTo(this.canvas.width,.5+t);this.context.stroke()},Barryvanveen.GameOfLife._getPosition=function(e){var t=0,i=0;if(e.offsetParent)do t+=e.offsetLeft,i+=e.offsetTop;while(e=e.offsetParent);return[t,i]},Barryvanveen.GameOfLife._initCells=function(){var e,t=this.config.num_cols;for(this.cells=[],this.newCells=[];t--;)for(this.cells[t]=[],this.newCells[t]=[],e=this.config.num_rows;e--;)this.cells[t][e]=0,this.newCells[t][e]=0},Barryvanveen.GameOfLife._initEventListeners=function(){var e=this;document.addEventListener?this.canvas.addEventListener("click",function(t){e._handleClick(t)},!1):document.attachEvent&&this.canvas.attachEvent("click",function(t){e._handleClick(t)})},Barryvanveen.GameOfLife._handleClick=function(e){var t=this._getCellFromCursorPosition(e);0!=t&&(this.cells[t[0]][t[1]]=!this.cells[t[0]][t[1]],this._drawCell(t[0],t[1]))},Barryvanveen.GameOfLife._getCellFromCursorPosition=function(e){var t,i;return"undefined"!=typeof e.pageX&&"undefined"!=typeof e.pageY?(t=e.pageX,i=e.pageY):(t=e.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,i=e.clientY+document.body.scrollTop+document.documentElement.scrollTop),t-=this.config.canvas_offset[0],i-=this.config.canvas_offset[1],t>this.config.num_cols*this.config.cell_size||i>this.config.num_rows*this.config.cell_size?!1:[Math.floor(t/this.config.cell_size),Math.floor(i/this.config.cell_size)]},Barryvanveen.GameOfLife._drawCell=function(e,t){this.cells[e][t]?this.context.fillStyle=this.config.color_cell_selected:this.context.fillStyle=this.config.color_cell_empty,this.context.fillRect(1+e*this.config.cell_size,1+t*this.config.cell_size,this.config.cell_size-1,this.config.cell_size-1)},Barryvanveen.GameOfLife.reset=function(){this.stop(),this._initCells(),this._initCanvas()},Barryvanveen.GameOfLife.start=function(){if(null==this.interval){var e=this;this.interval=setInterval(function(){e._computeNextGeneration()},this.config.update_interval)}},Barryvanveen.GameOfLife.step=function(){clearInterval(this.interval),this.interval=null,this._computeNextGeneration()},Barryvanveen.GameOfLife.stop=function(){clearInterval(this.interval),this.interval=null},Barryvanveen.GameOfLife._computeNextGeneration=function(){var e,t,i,n,s,o,c=0,l=!1;for(e=this.config.num_cols;e--;)for(t=this.config.num_rows;t--;){for(c=0,n=-1;1>=n;++n)for(i=-1;1>=i;++i)0==n&&0==i||(s=e+n,(0>s||s>=this.config.num_cols)&&(s=this._mod(this.config.num_cols,s)),o=t+i,(0>o||o>=this.config.num_rows)&&(o=this._mod(this.config.num_rows,o)),this.cells[s][o]&&c++);2>c||c>3?this.newCells[e][t]=0:2==c?this.newCells[e][t]=this.cells[e][t]:this.newCells[e][t]=1}for(e=this.config.num_cols;e--;)for(t=this.config.num_rows;t--;)this.cells[e][t]!=this.newCells[e][t]&&(this.cells[e][t]=this.newCells[e][t],this._drawCell(e,t),l=!0);l||this.stop()},Barryvanveen.GameOfLife._mod=function(e,t){return(t%e+e)%e};
//# sourceMappingURL=gameoflife.min.js.map
